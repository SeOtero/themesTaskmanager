import{r as d,j as e,q as g,b as h,d as f,w as v,o as j,e as N,f as I}from"./index-jQ7i3lSI.js";const E=({isOpen:r,onClose:w,user:s,userProfile:m,initialType:n})=>{const[a,i]=d.useState(n||"monday"),[x,p]=d.useState(""),[u,b]=d.useState([]);d.useEffect(()=>{r&&n&&i(n)},[r,n]),d.useEffect(()=>{r&&s&&(async()=>{try{const o=g(h(f,"monday_ideas"),v("uid","==",s.uid),j("timestamp","desc")),l=await N(o);b(l.docs.map(c=>({id:c.id,...c.data()})))}catch(o){console.error("Error history",o)}})()},[r,s]);const y=async()=>{if(!x.trim())return;const t=new Date,o={uid:s.uid,userName:m?.name||s.displayName||s.email,team:m?.team||"default",content:x,type:a,timestamp:Date.now(),timestampStr:t.toLocaleString("es-AR"),analysis:{pros:"",cons:""},status:"new"};try{const l=await I(h(f,"monday_ideas"),o);b(c=>[{id:l.id,...o},...c]),p(""),alert(a==="dev"?"üë®‚Äçüíª ¬°Enviado al Dev!":"üìÖ ¬°Guardado para el Lunes!")}catch(l){console.error(l),alert("Error al enviar.")}};return r?e.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fadeIn",children:e.jsxs("div",{className:"bg-[#0f111a] border border-white/10 rounded-2xl w-full max-w-lg shadow-2xl flex flex-col max-h-[85vh] overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsx("button",{onClick:()=>i("monday"),className:`flex-1 p-4 text-sm font-bold transition-colors ${a==="monday"?"bg-yellow-900/20 text-yellow-400 border-b-2 border-yellow-500":"text-slate-500 hover:text-slate-300"}`,children:"üí° Idea Lunes"}),e.jsx("button",{onClick:()=>i("dev"),className:`flex-1 p-4 text-sm font-bold transition-colors ${a==="dev"?"bg-purple-900/20 text-purple-400 border-b-2 border-purple-500":"text-slate-500 hover:text-slate-300"}`,children:"üë®‚Äçüíª Idea / Soporte"}),e.jsx("button",{onClick:w,className:"px-4 text-slate-400 hover:text-white border-l border-white/10",children:"‚úï"})]}),e.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[e.jsx("textarea",{className:`w-full bg-black/50 border rounded-lg p-3 text-white text-sm outline-none mb-3 h-32 resize-none focus:ring-1 ${a==="monday"?"border-yellow-900/50 focus:border-yellow-500":"border-purple-900/50 focus:border-purple-500"}`,placeholder:a==="monday"?"Describe tu propuesta para mejorar el equipo... Cuentan templates que falten o todo tema que queres que se trate el Lunes":"Quiero que la app haga esto... / La app tiene este error...",value:x,onChange:t=>p(t.target.value)}),e.jsx("button",{onClick:y,className:`w-full font-bold py-3 rounded-lg transition-colors mb-6 shadow-lg ${a==="monday"?"bg-yellow-600 hover:bg-yellow-500 text-white":"bg-purple-600 hover:bg-purple-500 text-white"}`,children:"ENVIAR"}),e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3 border-b border-white/10 pb-2",children:"Tu Historial Reciente"}),e.jsx("div",{className:"space-y-3",children:u.length>0?u.map(t=>e.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-[10px] text-slate-500",children:t.timestampStr?.split(",")[0]}),e.jsx("span",{className:`text-[10px] px-2 rounded font-bold ${t.status==="approved"?"bg-green-900/50 text-green-400":t.status==="rejected"?"bg-red-900/50 text-red-400":"bg-yellow-900/50 text-yellow-500"}`,children:t.status==="new"?"Pendiente":t.status==="approved"?"Aprobada":"Rechazada"})]}),e.jsx("p",{className:"text-xs text-slate-300 line-clamp-2",children:t.content})]},t.id)):e.jsx("p",{className:"text-xs text-slate-600 italic",children:"No hay historial a√∫n."})})]})]})}):null};export{E as default};
